{% extends 'hospital/base.html' %}
{% load static %}
{% block title %} :: I-Health:: Hospital Patients List {% endblock title %}

{% block custom_css %}{% endblock custom_css %}

{% block content %}
    <!-- Body: Body -->
        <div class="body d-flex py-3">
            <div class="container-xxl">
                <div class="row align-items-center">
                    <div class="border-0 mb-4">
                        <div class="card-header py-3 no-bg bg-transparent d-flex align-items-center px-0 justify-content-between border-bottom flex-wrap">
                            <h3 class="fw-bold mb-0">Patient List</h3>
                             <div class="col-auto d-flex w-sm-100">
                        <button type="button" class="btn btn-primary btn-set-task w-sm-100 " data-bs-toggle="modal" data-bs-target="#DoctorModalLg"><i class="icofont-plus-circle me-2 fs-6"></i>Add Patient</button>
                        
                    </div>
                        </div>
                    </div>
                </div> <!-- Row end  -->
                <div class="row mb-3">
                    <div class="card">
                        <div class="card-body">
                            <table id="patient-table" class="table table-hover align-middle mb-0" style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Patients</th>
                                        <th>Age</th>
                                        <th>Adress</th>
                                        <th>Gender</th>
                                        <th>Status</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                {% for hos_patient  in hos_patients %}
                                    <tr>
                                        <td>{{forloop.counter}}</td>
                                        <td>
                                        {% comment %} <img src="assets/images/xs/avatar3.jpg" class="avatar  rounded-circle me-2" alt="profile-image"> {% endcomment %}
                                        <span>{{hos_patient.name_title}} {{hos_patient.first_name}} {{hos_patient.last_name}}</span></td>
                                        <td>{{hos_patient.age}}</td>
                                        <td>{{hos_patient.address}}</td>
                                        <td>{{hos_patient.phone}}</td>
                                        <td><span class="badge {% if hos_patient.status == "OPD ONlY" %}bg-primary{% endif %}{% if hos_patient.status == "Admit" %}bg-info{% endif %}{% if hos_patient.status == "Discharge" %}bg-success{% endif %}">{{hos_patient.status}}</span></td>
                                         <td>
                                        <div class="btn-group" role="group" aria-label="Basic outlined example">
                                            <button type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#patientedit{{hos_patient.id}}"><i class="icofont-edit text-success"></i></button>
                                            
                                            <a type="button" class="btn btn-outline-secondary deleterow" id="deleteroom" href="{% url 'delete__hospital_patient' hos_patient.id %}" ><i class="icofont-ui-delete text-danger"></i><a>

                                        </div>
                                    </td>
                                    </tr>
                                   
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>


{% endblock content %}

{% block modal_fade %}
<!--Add Doctor Modal-->
<!-- Modal LG -->
<div class="modal fade" id="DoctorModalLg" tabindex="-1" aria-labelledby="DoctorModalLgLabel" aria-hidden="true"
    style="display: none;">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title h4" id="DoctorModalLgLabel">Add Patient</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-sm-12">
                        <div class="card mb-3">
                            <div class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0">
                                <h6 class="mb-0 fw-bold ">Patients Basic Inforamtion</h6>
                            </div>
                            <div class="card-body">
                                <form method="post" id="hpatientadd" enctype="multipart/form-data">
                                    {% csrf_token %}
                                    <div class="row g-3 align-items-center">
                                        <div class="col-md-2">
                                            <label class="form-label">Title *</label>
                                            <select class="form-select" aria-label="Default select example"
                                                name="name_title">
                                                <option {% if request.user.name_title == "Mr." %}selected{% endif %}
                                                    value="Mr."> Mr.</option>
                                                <option {% if request.user.name_title == "Mrs." %}selected{% endif %}
                                                    value="Mrs."> Mrs.</option>
                                                <option {% if request.user.name_title == "Miss" %}selected{% endif %}
                                                    value="Miss"> Miss</option>
                                                <option {% if request.user.name_title == "Ms." %}selected{% endif %}
                                                    value="Ms."> Ms.</option>
                                                <option {% if request.user.name_title == "Dr." %}selected{% endif %}
                                                    value="Dr."> Dr.</option>
                                            </select>
                                        </div>
                                        <div class="col-md-5">
                                            <label for="firstname" class="form-label">First Name *</label>
                                            <input type="text" class="form-control" id="firstname" name="first_name">
                                        </div>
                                        <div class="col-md-5">
                                            <label for="lastname" class="form-label">Last Name *</label>
                                            <input type="text" class="form-control" id="lastname" name="last_name">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="address" class="form-label">Address </label>
                                            <input type="text" class="form-control" id="address" name="address">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="city" class="form-label">City </label>
                                            <input type="text" class="form-control" id="city" name="city">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="age" class="form-label">Age </label>
                                            <input type="text" class="form-control" id="dob" name="age">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="phonenumber" class="form-label">Phone Number *</label>
                                            <input type="text" class="form-control" id="phonenumber" name="phone">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="emailaddress" class="form-label">Email Address</label>
                                            <input type="email" class="form-control" id="emailaddress" name="email">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="ID_number" class="form-label">ID proof Number </label>
                                            <input type="text" class="form-control" id="phonenumber" name="ID_number">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="formFileMultiple" class="form-label">ID Proof Upload</label>
                                            <input class="form-control" type="file" id="formFileMultiple"
                                                name="ID_proof">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Gender *</label>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" name="gender"
                                                            id="gender" value="Male" checked>
                                                        <label class="form-check-label" for="exampleRadios11">
                                                            Male
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" name="gender"
                                                            id="gender" value="Female" <label class="form-check-label"
                                                            for="exampleRadios22">
                                                        Female
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Status *</label>
                                            <select class="form-select" aria-label="Default select example"
                                                name="status">
                                                <option selected disabled>Select Status</option>
                                                <option value="OPD ONlY">OPD Only</option>
                                                <option value="Admit">Admit</option>
                                                <option value="Discharge">Discharge</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Treatment </label>
                                            <input type="text" class="form-control" id="phonenumber" name="treatment">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="addnote" class="form-label">Add Note</label>
                                            <textarea class="form-control" id="addnote" name="add_notes"
                                                rows="3"></textarea>
                                        </div>
                                    </div>

                                    <button type="submit" class="btn btn-primary mt-4">Submit</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--End Add Doctor-->
<!--Edit Doctor Modal-->
<!-- Modal LG -->
{% for hos_patient in hos_patients  %}
<div class="modal fade" id="patientedit{{hos_patient.id}}" tabindex="-1" aria-labelledby="DoctorModalLgLabel" aria-hidden="true"
    style="display: none;">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title h4" id="DoctorModalLgLabel">Add Patient</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-sm-12">
                        <div class="card mb-3">
                            <div class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0">
                                <h6 class="mb-0 fw-bold ">Patients Basic Inforamtion</h6>
                            </div>
                            <div class="card-body">
                                <form method="post" id="hpatientedit" enctype="multipart/form-data" action="{% url 'update_patient' %}">
                                    {% csrf_token %}
                                    <div class="row g-3 align-items-center">
                                        <div class="col-md-2">
                                            <label class="form-label">Title *</label>
                                            <select class="form-select" aria-label="Default select example"
                                                name="name_title">
                                                <option {% if hos_patient.name_title == "Mr." %}selected{% endif %}
                                                    value="Mr."> Mr.</option>
                                                <option {% if hos_patient.name_title == "Mrs." %}selected{% endif %}
                                                    value="Mrs."> Mrs.</option>
                                                <option {% if hos_patient.name_title == "Miss" %}selected{% endif %}
                                                    value="Miss"> Miss</option>
                                                <option {% if hos_patient.name_title == "Ms." %}selected{% endif %}
                                                    value="Ms."> Ms.</option>
                                                <option {% if hos_patient.name_title == "Dr." %}selected{% endif %}
                                                    value="Dr."> Dr.</option>
                                            </select>
                                        </div>
                                        <div class="col-md-5">
                                            <label for="firstname" class="form-label">First Name *</label>
                                            <input type="text" class="form-control" id="firstname" value="{{hos_patient.first_name}}" name="first_name">
                                        </div>
                                        <div class="col-md-5">
                                            <label for="lastname" class="form-label">Last Name *</label>
                                            <input type="text" class="form-control" id="lastname" value="{{hos_patient.last_name}}" name="last_name">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="address" class="form-label">Address </label>
                                            <input type="text" class="form-control" id="address" value="{{hos_patient.address}}" name="address">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="city" class="form-label">City </label>
                                            <input type="text" class="form-control" id="city" value="{{hos_patient.city}}" name="city">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="age" class="form-label">Age </label>
                                            <input type="text" class="form-control" id="dob" value="{{hos_patient.age}}" name="age">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="phonenumber" class="form-label">Phone Number *</label>
                                            <input type="text" class="form-control" id="phonenumber" value="{{hos_patient.phone}}" name="phone">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="emailaddress" class="form-label">Email Address</label>
                                            <input type="email" class="form-control" id="emailaddress" value="{{hos_patient.email}}" name="email">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="ID_number" class="form-label">ID proof Number </label>
                                            <input type="text" class="form-control" id="phonenumber" value="{{hos_patient.ID_number}}" name="ID_number">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="formFileMultiple" class="form-label">ID Proof Upload</label>
                                            <input class="form-control" type="file" id="formFileMultiple"
                                                name="ID_proof">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Gender *</label>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" name="gender"
                                                            id="gender" value="Male" {% if hos_patient.gender == "Male" %}checked{% endif %} >
                                                        <label class="form-check-label" for="exampleRadios11">
                                                            Male
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" name="gender"
                                                            id="gender" value="Female" {% if hos_patient.gender == "Female" %}checked{% endif %} ><label class="form-check-label"
                                                            for="exampleRadios22">
                                                        Female
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Status *</label>
                                            <select class="form-select" aria-label="Default select example"
                                                name="status">
                                                <option selected disabled>Select Status</option>
                                                <option {% if hos_patient.status == "OPD ONlY" %}selected{% endif %}value="OPD ONlY">OPD Only</option>
                                                <option  {% if hos_patient.status == "Admit" %}selected{% endif %} value="Admit">Admit</option>
                                                <option  {% if hos_patient.status == "Discharge" %}selected{% endif %} value="Discharge">Discharge</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Treatment </label>
                                            <input type="text" class="form-control" id="phonenumber" name="treatment" value="{{hos_patient.treatment}}">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="addnote" class="form-label">Add Note</label>
                                            <textarea class="form-control" id="addnote" name="add_notes"
                                                rows="3">{{hos_patient.add_notes}}</textarea>
                                        </div>
                                        <input type="hidden" value="{{hos_patient.id}}" name="id">
                                    </div>

                                    <button type="submit" class="btn btn-primary mt-4">Submit</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endfor %}
<!--End Edit Patient-->



{% endblock modal_fade %}

{% block custom_js %}
<script>
 $(".submit_btn").click(function(){
        var form=new FormData($("#hpatientedit"));
       // form.append("long_desc",tinyMCE.activeEditor.getContent());

        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: "{% url 'update_patient' %}",
            data:form,
            success: function (json) {
                console.log(json)
            },
            error: function (xhr, errmsg, err) {

            }
        });
        //Ajax code

        
       // setTimeout(location.reload.bind(location), 2000);

        //update staff from edit page fade
       

    })
</script>
<script>
     $(document).ready(function() {
        $('#patient-table')
        .addClass( 'nowrap' )
        .dataTable( {
            responsive: true,
            columnDefs: [
                { targets: [-1, -3], className: 'dt-body-right' }
            ]
        });
    });

</script>
{% endblock custom_js %}